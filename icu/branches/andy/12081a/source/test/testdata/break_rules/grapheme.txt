#
# One line per rule or set definition. No continuation. Trailing # comments.
# 
#
# Set definitions go at top, before rules.

# tailorings: if a tailoring redeines a class, it replaces the original definition.
#             if it depends on previous definition, place just after the previous def.

# maybe let builder sort out ordering, tailorings may splatter things around.

# Rule labels:   letter+ digit+ suffix?
# suffix:        letter (letter | digit)*

# sort with the first numeric field embedded in the name in numeric order,
# otherwise in code point order.

# Flag error if source rules not in order.

# Set Substitutions:
#   Substitutions take place in both rules and set definitions.
#   Need to avoid replacing literal property names or values. Examples
#      H2 = [:LineBreak =  H2:];
#      Extend = [\p{Grapheme_Cluster_Break = Extend}];
#   Set name: Letter (letter | digit)*
#   Repaceable set name: not preceded by ('{' | '=' | '[:') space*

# Tailorings
# + rule or def. Add it.
# - rule name or def name. Remove it.
# ! rule or def. Replace existing. Error if not there.
#
# Replace goes at position of original def.
# Add goes just after any existing def, or after existing defs if not already defined.
# Rules go in sorted order.

# type and locale are reserved;
# they tell the test what kind of break iterator to create & test against these rules.

type = grapheme;      # one of grapheme | word | line | sentence
locale = en;

# Tailoring. If the following rules are a tailoring, specify the base set of rules being tailored.
# baserules = file_name;

CR = [\u000d];  
LF = [\u000a];

Control            = [[\p{Grapheme_Cluster_Break = Control}]-[:Block=Tags:]];
Extend             = [[\p{Grapheme_Cluster_Break = Extend}][:Block=Tags:]];
Regional_Indicator = [\p{Grapheme_Cluster_Break = Regional_Indicator}];
Prepend            = [];
SpacingMark        = [\p{Grapheme_Cluster_Break = SpacingMark}];
E_Base             = [\u261D\u26F9\u270A-\u270D\U0001F385\U0001F3C3-\U0001F3C4\U0001F3CA-\U0001F3CB\U0001F442-\U0001F443\U0001F446-\U0001F450\U0001F466-\U0001F469\U0001F46E\U0001F470-\U0001F478\U0001F47C\U0001F481-\U0001F483\U0001F485-\U0001F487\U0001F4AA\U0001F575\U0001F590\U0001F595-\U0001F596\U0001F645-\U0001F647\U0001F64B-\U0001F64F\U0001F6A3\U0001F6B4-\U0001F6B6\U0001F6C0\U0001F918];
E_Modifier         = [\U0001F3FB-\U0001F3FF];
GAZ                = [\U0001F455-\U0001F469\U0001F48B\U0001F5E8\u2764];
ZWJ                = [\u200D];

#
# Korean Syllable Definitions
#
L       = [\p{Grapheme_Cluster_Break = L}];
V       = [\p{Grapheme_Cluster_Break = V}];
T       = [\p{Grapheme_Cluster_Break = T}];

LV      = [\p{Grapheme_Cluster_Break = LV}];
LVT     = [\p{Grapheme_Cluster_Break = LVT}];

GB3:     CR LF;   # allow trailing comment.
GB4:     (Control | CR | LF) รท;
GB5:     . รท (Control | CR | LF);

GB6:     L (L | V | LV | LVT);
GB7:     (LV | V) (V | T);
GB8:     (LVT | T) T;

# Regional Indicators, split into pairs.
#      Note that a pair of RIs that is not followed by a third RI will fall into
#      the normal rules for Extend, etc.
#                 
GB8a.1:  Regional_Indicator Regional_Indicator รท Regional_Indicator;
GB8a.2:  Regional_Indicator Regional_Indicator;

GB9:     . Extend;

GB9a:    . SpacingMark;
GB9b:    Prepend .;
GB9c:    (E_Base | GAZ) E_Modifier;
GB9d:    ZWJ GAZ;

GB10:     . รท;
